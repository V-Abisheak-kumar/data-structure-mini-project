# E-commerce Sales Data Wrangling - SDG 12 (Responsible Consumption)

import pandas as pd

# Load data
df = pd.read_csv("ecommerce_sales.csv")

# --- 1. Data Cleaning ---
# Drop duplicates
df.drop_duplicates(inplace=True)

# Handle missing values
df['Quantity'].fillna(0, inplace=True)
df['Revenue'].fillna(df['Revenue'].mean(), inplace=True)

# Standardize column names
df.columns = df.columns.str.strip().str.lower().str.replace(' ', '_')

# --- 2. Data Grouping ---
# Group by product and region to summarize sales
grouped_df = df.groupby(['product_category', 'region']).agg({
    'quantity': 'sum',
    'revenue': 'sum'
}).reset_index()

# --- 3. Data Pivoting ---
# Pivot table to compare revenue by product and month
pivot_df = pd.pivot_table(df,
                          index='product_category',
                          columns='month',
                          values='revenue',
                          aggfunc='sum',
                          fill_value=0)

# --- 4. Output Cleaned Data ---
grouped_df.to_csv("cleaned_grouped_sales.csv", index=False)
pivot_df.to_csv("pivot_sales.csv")

print("âœ… Data cleaning, grouping, and pivoting completed successfully.")
